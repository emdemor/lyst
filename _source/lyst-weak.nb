(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    142769,       3326]
NotebookOptionsPosition[    137810,       3238]
NotebookOutlinePosition[    138147,       3253]
CellTagsIndexPosition[    138104,       3250]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["LyST - Weak Field Equations ", "Title",ExpressionUUID->"117238c6-4506-4b0f-b7d7-a743167ebbfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Notation`AutoLoadNotationPalette", " ", "=", " ", "False"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Red", " ", "variable", " ", "goes", " ", "to", " ", "black"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"$FrontEndSession", ",", 
    RowBox[{"AutoStyleOptions", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<SymbolShadowingStyle\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"FontColor", "->", "Black"}], "}"}]}], "}"}]}]}], "]"}], "\n",
   "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "are", " ", "the", " ", "symbols", " ", "used", " ", "to", 
    " ", "designate", " ", "up", " ", "and", " ", "down", " ", "index"}], " ",
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"u", ",", "d"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"u", ",", "d"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", "u"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", "d"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"u", ",", "d"}], "]"}], ";"}]}], "Code",
 CellLabel->"In[1]:=",ExpressionUUID->"54a1dfe7-3b5d-43d4-b5ce-74f2c5cc3c3c"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"Symbolize", "::", "bsymbexs"}], "]"}]], "Code",
 CellLabel->"In[9]:=",ExpressionUUID->"e8d87e34-e868-49a2-b103-3c6aea785bbd"],

Cell[CellGroupData[{

Cell["Notations", "Section",ExpressionUUID->"bef6e7d3-2855-4e16-b213-502980ed799f"],

Cell["Kroneceker Delta", "TextIndent",ExpressionUUID->"d27fdd2e-5569-46e3-bd26-6b6af0518953"],

Cell[BoxData[{
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SubsuperscriptBox", "[", 
     RowBox[{
     "\"\<\[Delta]\>\"", ",", " ", "\"\<i_\>\"", ",", " ", "\"\<j_\>\""}], 
     "]"}], "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<KroneckerDelta\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\""}], "}"}],
         "]"}], ",", " ", "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}], "\n", 
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SubscriptBox", "[", 
     RowBox[{"\"\<\[Delta]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\""}],
         "}"}], "]"}]}], "]"}], "]"}], " ", "\[DoubleLongLeftRightArrow]", 
   " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<KroneckerDelta\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\""}], "}"}],
         "]"}], ",", " ", "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}], "\n", 
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{"\"\<\[Delta]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\""}],
         "}"}], "]"}]}], "]"}], "]"}], " ", "\[DoubleLongLeftRightArrow]", 
   " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<KroneckerDelta\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\""}], "}"}],
         "]"}], ",", " ", "\"\<]\>\""}], "}"}], "]"}], "]"}]}], 
  "]"}]}], "Code",
 CellLabel->"In[10]:=",ExpressionUUID->"57300198-a71e-4459-aab1-d94c1243b856"],

Cell["Levi Civita Symbol", "TextIndent",ExpressionUUID->"71c64f7c-ae1b-4592-ac0e-0a2dcd6362be"],

Cell[BoxData[{
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SubscriptBox", "[", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
         " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\""}], "}"}], "]"}]}], "]"}], 
    "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<LeviCivitaTensor\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
          "\"\<3\>\"", ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
       "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<[\>\"", ",", " ", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
             " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\""}], "}"}], "]"}], ",", 
          " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], "}"}], 
     "]"}], "]"}]}], "]"}], "\n", 
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
         " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\""}], "}"}], "]"}]}], "]"}], 
    "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<LeviCivitaTensor\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
          "\"\<3\>\"", ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
       "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<[\>\"", ",", " ", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
             " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\""}], "}"}], "]"}], ",", 
          " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], "}"}], 
     "]"}], "]"}]}], "]"}], "\n", 
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SubscriptBox", "[", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
         " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\"", ",", " ", "\"\<,\>\"", ",",
          " ", "\"\<l_\>\""}], "}"}], "]"}]}], "]"}], "]"}], " ", 
   "\[DoubleLongLeftRightArrow]", " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<LeviCivitaTensor\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
          "\"\<4\>\"", ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
       "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<[\>\"", ",", " ", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<i_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<j_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<k_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<l_\>\""}], 
               "}"}], "]"}]}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], "}"}], 
        "]"}], ",", " ", "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}], "\n", 
 RowBox[{"Notation", "[", 
  RowBox[{
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", " ", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<i_\>\"", ",", " ", "\"\<,\>\"", ",", " ", "\"\<j_\>\"", ",", 
         " ", "\"\<,\>\"", ",", " ", "\"\<k_\>\"", ",", " ", "\"\<,\>\"", ",",
          " ", "\"\<l_\>\""}], "}"}], "]"}]}], "]"}], "]"}], " ", 
   "\[DoubleLongLeftRightArrow]", " ", 
   RowBox[{"ParsedBoxWrapper", "[", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<LeviCivitaTensor\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
          "\"\<4\>\"", ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
       "\"\<[\>\"", ",", " ", 
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<[\>\"", ",", " ", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<i_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<j_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<k_\>\""}], 
               "}"}], "]"}], ",", " ", "\"\<,\>\"", ",", " ", 
             RowBox[{"RowBox", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", "\"\<l_\>\""}], 
               "}"}], "]"}]}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], "}"}], 
        "]"}], ",", " ", "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}]}], "Code",\

 CellLabel->"In[13]:=",ExpressionUUID->"0bb69e37-aa99-4e96-bd4f-08efa53301b1"],

Cell["Usefull Symbols", "TextIndent",ExpressionUUID->"38b5b725-cd4e-423c-be2e-87acad8783e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   RowBox[{
    TemplateBox[{SubscriptBox["x_", "ind_"]},
     "NotationTemplateTag"], ",", 
    RowBox[{"WorkingForm", "\[Rule]", "TraditionalForm"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Symbolize", "[", 
    RowBox[{
     TemplateBox[{SuperscriptBox["x", "ind_"]},
      "NotationTemplateTag"], ",", 
     RowBox[{"WorkingForm", "\[Rule]", "TraditionalForm"}]}], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"A", " ", "partir", " ", "daqui"}], ",", " ", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", "\[EAcute]", " ", "diferente", " ", "de", 
     " ", 
     SuperscriptBox[
      RowBox[{"(", "x", ")"}], "2"]}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{SubscriptBox["\[DoubleStruckG]", "\[Mu]_"]},
    "NotationTemplateTag"], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{SuperscriptBox["\[DoubleStruckG]", "\[Mu]_"]},
    "NotationTemplateTag"], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{SqrtBox[
      RowBox[{"-", "g"}]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Code",
 CellLabel->"In[17]:=",ExpressionUUID->"140996a3-a03b-424a-922e-4bacaf5a002d"],

Cell["Assumptions", "TextIndent",ExpressionUUID->"9ef7381e-6eba-46c9-80c6-6f3f803182fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAssumption", "[", "list`var_List", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"$Assumptions", ",", "#"}], "]"}], "&"}], "/@", "list`var"}]}], 
  ";"}]}], "Code",
 CellLabel->"In[22]:=",ExpressionUUID->"071970c7-f3ea-4260-9a38-72ee982cf2c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",ExpressionUUID->"c949827c-b67c-4457-84a3-784f7f6bb683"],

Cell["Set Variables to be Protected", "TextIndent",ExpressionUUID->"588eadd5-e3e4-4d90-9106-34a8939d7737"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FreeVariable", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FreeVariable", "[", "label_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "VarLabel", "}"}], ",", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"VarLabel", " ", "=", " ", 
       RowBox[{"SymbolName", "[", 
        RowBox[{"Unevaluated", "[", "label", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Unprotect", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", "\n", "      ", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";"}]}], "\n", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ReserveVariable", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReserveVariable", "[", "label_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "VarLabel", "}"}], ",", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"VarLabel", " ", "=", " ", 
       RowBox[{"SymbolName", "[", 
        RowBox[{"Unevaluated", "[", "label", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Unprotect", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", "\n", 
      "       ", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{"Unevaluated", "[", "label", "]"}], " ", "=", " ", 
       RowBox[{"Unevaluated", "[", "label", "]"}]}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Protect", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "label"}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"SetVariable", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetVariable", "[", 
    RowBox[{"label_", ",", "value_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "VarLabel", "}"}], ",", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"VarLabel", " ", "=", " ", 
       RowBox[{"SymbolName", "[", 
        RowBox[{"Unevaluated", "[", "label", "]"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"Unprotect", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", "\n", 
      "       ", 
      RowBox[{"ClearAll", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"Unevaluated", "[", "label", "]"}], " ", "=", " ", "value"}], 
      ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"Protect", "[", 
       RowBox[{"Evaluate", "[", "VarLabel", "]"}], "]"}], ";"}]}], "\n", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetVariableByString", "[", 
   RowBox[{"label_", ",", "value_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "VarLabel", "}"}], ",", " ", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{
      "\"\<SetVariable[\>\"", "<>", "label", "<>", "\"\<,\>\"", "<>", 
       RowBox[{"ToString", "[", "value", "]"}], "<>", "\"\<]\>\""}], "]"}], 
     ";"}]}], "\n", "]"}]}], "\[IndentingNewLine]"}], "Code",
 CellLabel->"In[24]:=",ExpressionUUID->"3ec4399e-3bc6-445d-9b5a-cf677b0add8f"],

Cell["Subscrips and Superscripts Labels", "TextIndent",ExpressionUUID->"51e1557d-f923-41a3-83eb-4697de2d3ff9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubscriptNumber", "[", "ind_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\:2080\>\"", ",", "\"\<\:2081\>\"", ",", "\"\<\:2082\>\"", ",", 
      "\"\<\:2083\>\"", ",", "\"\<\:2084\>\"", ",", "\"\<\:2085\>\"", ",", 
      "\"\<\:2086\>\"", ",", "\"\<\:2087\>\"", ",", "\"\<\:2088\>\"", ",", 
      "\"\<\:2089\>\""}], "}"}], "[", 
    RowBox[{"[", 
     RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SuperscriptNumber", "[", "ind_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\:2070\>\"", ",", "\"\<\.b9\>\"", ",", "\"\<\.b2\>\"", ",", 
      "\"\<\.b3\>\"", ",", "\"\<\:2074\>\"", ",", "\"\<\:2075\>\"", ",", 
      "\"\<\:2076\>\"", ",", "\"\<\:2077\>\"", ",", "\"\<\:2078\>\"", ",", 
      "\"\<\:2079\>\""}], "}"}], "[", 
    RowBox[{"[", 
     RowBox[{"ind", "+", "1"}], "]"}], "]"}]}], ";"}]}], "Code",
 CellLabel->
  "In[177]:=",ExpressionUUID->"01c358b0-1fbc-4f6e-b0c4-adf83cbf7350"],

Cell["Subscrips and Superscripts Labels", "TextIndent",ExpressionUUID->"bab1d243-63d0-4544-a66c-ee8d8b15ea04"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReserveVariable", "[", "TestandoSom", "]"}]], "Code",
 CellLabel->"In[31]:=",ExpressionUUID->"8a93146a-104e-4b21-a1ab-e9285ddc69d2"],

Cell[BoxData["TestandoSom"], "Output",
 CellLabel->"Out[31]=",ExpressionUUID->"1e370418-7caf-4af4-9d0d-8ca618d7a4b5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard Values", "Section",ExpressionUUID->"3a77df19-f3c2-408a-a93e-0aaf75c43092"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Minkowski", " ", "Metric"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SetMinkowski", "[", "\[DoubleStruckCapitalD]_", "]"}], " ", ":=",
      " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "TempMetric", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TempMetric", " ", "=", 
         RowBox[{"Table", "[", "\n", "\t ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "!=", "j"}], ",", "0", ",", "\n", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "==", "1"}], ",", "1", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "\n", "\t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "\[DoubleStruckCapitalD]"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "\[DoubleStruckCapitalD]"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SetVariable", "[", 
         RowBox[{"MinkowskiMetricCov", ",", "TempMetric"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetVariable", "[", 
         RowBox[{"MinkowskiMetricCon", ",", "TempMetric"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDimension", "[", "Dim_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "  ", 
      RowBox[{
       RowBox[{"SetVariable", "[", 
        RowBox[{"\[DoubleStruckCapitalD]", ",", "Dim"}], "]"}], ";", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"SetVariable", "[", 
        RowBox[{"n", ",", 
         RowBox[{"\[DoubleStruckCapitalD]", "-", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"SetMinkowski", "[", "\[DoubleStruckCapitalD]", "]"}], ";"}]}],
      "\n", "]"}]}], "\n"}]}]], "Code",ExpressionUUID->"a86929e7-4172-4f88-\
b1de-30656716a53f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"MinkCov\"\>", ",", "\<\"MinkCon\"\>"}], "}"}]], "Output",
 CellLabel->
  "Out[199]=",ExpressionUUID->"a7cbcc99-e616-4a3c-915d-f386c7ed017f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Infinitesimal Variables", "Section",ExpressionUUID->"dba31cef-fb8b-4d2a-be39-f909bb49dc6d"],

Cell[BoxData[{
 RowBox[{"FreeVariable", "[", "TestInfinityVariable", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetVariable", "[", 
   RowBox[{"InfinitesimalVariables", ",", 
    RowBox[{"{", "TestInfinityVariable", "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DeclareInfinitesimal", "[", "var_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"InfinitesimalVariables", ",", "var"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListExpansionVar", " ", ":=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"var", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"var", ",", "InfinitesimalVariables"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UpdateInfinitesimalVariables", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "TempVar", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TempVar", " ", "=", " ", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{
             RowBox[{"var1", " ", "var2"}], "\[Rule]", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"var1", ",", "InfinitesimalVariables"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"var2", ",", "InfinitesimalVariables"}], "}"}]}], "]"}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"SetVariable", "[", 
       RowBox[{"ListNullOrders", " ", ",", "TempVar"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FirstOrder", "[", "eq_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Expand", "[", "eq", "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Sequence", "@@", "ListExpansionVar"}], " ", "]"}]}], 
         "]"}], "//", "Normal"}], "]"}], "/.", "ListNullOrders"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Code",Exp\
ressionUUID->"b31d658d-b908-4e64-acb3-ff989cd9aa12"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gran Func", "Section",ExpressionUUID->"f9efed55-f219-4e9f-880d-2405559b2651"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ReserveVariable", "[", "Scale", "]"}], " "}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"efebd265-3695-445d-bc35-a9eba5b46fea"],

Cell[BoxData["Scale"], "Output",
 CellLabel->"Out[33]=",ExpressionUUID->"b8be12d7-1e79-4497-aff5-17e5a7054ec2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetVariable", "[", 
    RowBox[{"CheckCoordinates", ",", "False"}], "]"}], ";"}], "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SetLyraManifold", "]"}], " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ReserveVariable", "[", "CoordinatesList", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"x\:2070", ",", "x\.b9", ",", "x\.b2", ",", "x\.b3"}], 
        "}"}]}], " ", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReserveVariable", "[", "Scale", "]"}], "      ", "\[Rule]", 
       " ", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReserveVariable", "[", "ScalePerturbation", "]"}], "      ", 
       "\[Rule]", " ", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReserveVariable", "[", "ScalePerturbationLabel", "]"}], " ", 
       "\[Rule]", "  ", "\"\<\[Delta]\[Phi]\>\""}], ",", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReserveVariable", "[", "ScalePerturbationDependencies", "]"}],
        " ", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"x\:2070", ",", "x\.b9", ",", "x\.b2", ",", "x\.b3"}], 
        "}"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetLyraManifold", "[", 
   RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "\[DoubleStruckCapitalX]`var", ",", "\[CapitalPhi]bg", ",", 
      "\[CapitalPhi]pert", ",", "Xtring", ",", "pLabel", ",", "pDep", ",", 
      "PertQ", ",", "\[CapitalDelta]\[CapitalPhi]"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**"}], "**", "**"}], "*", " ", "1.", " ", 
      "Coordinates"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", "\"\<[info] Coordinates...\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[DoubleStruckCapitalX]`var", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "CoordinatesList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"\[DoubleStruckCapitalX]str", ",", 
       RowBox[{"(", 
        RowBox[{"ToString", "/@", "\[DoubleStruckCapitalX]`var"}], ")"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"\[DoubleStruckCapitalX]", ",", "\[DoubleStruckCapitalX]`var"}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"\[DoubleStruckX]", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"in", ",", 
         RowBox[{"\[DoubleStruckCapitalX]", "[", 
          RowBox[{"[", 
           RowBox[{"1", "+", "in"}], "]"}], "]"}]}], " ", "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"FreeVariable", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{RowBox[{
           SubscriptBox["\[PartialD]", "n_"], "Func_"}]},
        "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{RowBox[{"Simplify", "[", 
           RowBox[{"D", "[", 
             RowBox[{"Func_", ",", 
               RowBox[{"\[DoubleStruckX]", "[", "n_", "]"}]}], "]"}], "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{RowBox[{
           SubscriptBox["\[PartialD]", "n_"], 
           RowBox[{"[", "Func_", "]"}]}]},
        "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{RowBox[{"Simplify", "[", 
           RowBox[{"D", "[", 
             RowBox[{"Func_", ",", 
               RowBox[{"\[DoubleStruckX]", "[", "n_", "]"}]}], "]"}], "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\n", "    ", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{SuperscriptBox["x", "i_"]},
        "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{RowBox[{"\[DoubleStruckX]", "[", "i_", "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Protect", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetDimension", "[", "\[DoubleStruckCapitalX]`var", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**"}], "**", "**"}], "*", " ", "2.", " ", "Scale"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PertQ", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "ScalePerturbation", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pLabel", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "ScalePerturbationLabel", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pDep", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "ScalePerturbationDependencies", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalPhi]pert", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PertQ", "===", "False"}], ",", "0", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Xtring", "  ", "=", " ", 
          RowBox[{"\"\<[\>\"", "<>", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "pDep"}], ",", "\"\<,\>\""}], "]"}], 
            "]"}], "<>", "\"\<]\>\""}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]\[CapitalPhi]", " ", "=", " ", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"pLabel", "<>", "Xtring"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "DeclareInfinitesimal", "[", "\[CapitalDelta]\[CapitalPhi]", "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"diff\[CapitalDelta]\[CapitalPhi]1", " ", "=", "  ", 
             RowBox[{"D", "[", 
              RowBox[{"\[CapitalDelta]\[CapitalPhi]", ",", "\[ScriptX]1"}], 
              "]"}]}], " ", ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
             "InfinitesimalVariables", ",", 
              "diff\[CapitalDelta]\[CapitalPhi]1"}], "]"}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"InfinitesimalVariables", " ", "=", " ", 
             RowBox[{
             "DeleteDuplicates", "[", "InfinitesimalVariables", "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"diff\[CapitalDelta]\[CapitalPhi]2", " ", "=", " ", 
                RowBox[{"D", "[", 
                 RowBox[{
                 "diff\[CapitalDelta]\[CapitalPhi]1", ",", "\[ScriptX]2"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], ";",
                "\[IndentingNewLine]", "\t\t", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                "InfinitesimalVariables", ",", 
                 "diff\[CapitalDelta]\[CapitalPhi]2"}], "]"}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"InfinitesimalVariables", " ", "=", " ", 
                RowBox[{
                "DeleteDuplicates", "[", "InfinitesimalVariables", "]"}]}], 
               ";", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], ";"}],
               "\[IndentingNewLine]", "\t\t", ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptX]2", ",", "\[DoubleStruckCapitalX]"}], 
               "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[ScriptX]1", ",", "\[DoubleStruckCapitalX]"}], "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         "\[CapitalDelta]\[CapitalPhi]"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalPhi]var", "=", 
      RowBox[{"OptionValue", "[", "Scale", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"\[CapitalPhi]", ",", 
       RowBox[{"\[CapitalPhi]var", "+", "\[CapitalPhi]pert"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"Diff\[CapitalPhi]1", " ", ",", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"\[CapitalPhi]", ",", "\[ScriptX]"}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptX]", ",", "\[DoubleStruckCapitalX]"}], "}"}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"Diff\[CapitalPhi]2", " ", ",", " ", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"\[CapitalPhi]", ",", "\[ScriptX]1"}], "]"}], ",", 
           "\[ScriptX]2"}], "]"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptX]1", ",", "\[DoubleStruckCapitalX]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptX]2", ",", "\[DoubleStruckCapitalX]"}], "}"}]}], 
        "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{RowBox[{
           SubscriptBox["\[PartialD]", "i_"], "\[CapitalPhi]"}]},
        "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{RowBox[{"Diff\[CapitalPhi]1", "[", 
           RowBox[{"[", 
             RowBox[{"i_", "+", "1"}], "]"}], "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\n", "\t", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{RowBox[{
           SubscriptBox["\[PartialD]", "i_"], 
           RowBox[{
             SubscriptBox["\[PartialD]", "j_"], "\[CapitalPhi]"}]}]},
        "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{RowBox[{"Diff\[CapitalPhi]2", "[", 
           RowBox[{"[", 
             RowBox[{
               RowBox[{"i_", "+", "1"}], ",", 
               RowBox[{"j_", "+", "1"}]}], "]"}], "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"CheckScale", " ", ",", " ", "True"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"UpdateInfinitesimalVariables", "[", "]"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Code",
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"23322569-a03b-41a5-a115-0313470b4cc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Coordinates", "Section",ExpressionUUID->"2b3c5ccf-c52e-41f9-9b47-8dc9d657a024"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetVariable", "[", 
    RowBox[{"CheckCoordinates", ",", "False"}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetCoordinates", "[", "\[DoubleStruckCapitalX]`var_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetVariable", "[", 
        RowBox[{"\[DoubleStruckCapitalX]str", ",", 
         RowBox[{"(", 
          RowBox[{"ToString", "/@", "\[DoubleStruckCapitalX]`var"}], ")"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetVariable", "[", 
        RowBox[{
        "\[DoubleStruckCapitalX]", ",", "\[DoubleStruckCapitalX]`var"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FreeVariable", "[", "\[DoubleStruckX]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[DoubleStruckX]", "[", "in_", "]"}], ":=", 
        RowBox[{"\[DoubleStruckCapitalX]", "[", 
         RowBox[{"[", 
          RowBox[{"1", "+", "in"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "\[DoubleStruckX]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FreeVariable", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Notation", "[", 
        RowBox[{
         TemplateBox[{RowBox[{
             SubscriptBox["\[PartialD]", "n_"], "Func_"}]},
          "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
         TemplateBox[{RowBox[{"Simplify", "[", 
             RowBox[{"D", "[", 
               RowBox[{"Func_", ",", 
                 RowBox[{"\[DoubleStruckX]", "[", "n_", "]"}]}], "]"}], "]"}]},
          "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Notation", "[", 
        RowBox[{
         TemplateBox[{RowBox[{
             SubscriptBox["\[PartialD]", "n_"], 
             RowBox[{"[", "Func_", "]"}]}]},
          "NotationTemplateTag"], " ", "\[DoubleLongRightArrow]", " ", 
         TemplateBox[{RowBox[{"Simplify", "[", 
             RowBox[{"D", "[", 
               RowBox[{"Func_", ",", 
                 RowBox[{"\[DoubleStruckX]", "[", "n_", "]"}]}], "]"}], "]"}]},
          "NotationTemplateTag"]}], "]"}], ";", "\n", "\t", 
       RowBox[{"Notation", "[", 
        RowBox[{
         TemplateBox[{SuperscriptBox["x", "i_"]},
          "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
         TemplateBox[{RowBox[{"\[DoubleStruckX]", "[", "i_", "]"}]},
          "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SetVariable", "[", 
        RowBox[{"CheckCoordinates", ",", "True"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ErrorCoordinatesMessage", " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", "CheckCoordinates"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Error. You must define coordinates first.\>\"", 
      "]"}]}], "]"}]}], ";"}]}], "Code",ExpressionUUID->"598caa73-de07-4b88-\
8bec-c51385d135f3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining Lyra Scale Function", "Section",ExpressionUUID->"55a0b5c5-2c21-4a16-97e6-5ec3b238814a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetVariable", "[", 
    RowBox[{"CheckScale", " ", ",", " ", "False"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ReserveVariable", "[", "Perturbation", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReserveVariable", "[", "PerturbationLabel", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReserveVariable", "[", "PerturbationDependencies", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "SetScaleFunction", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SetScaleFunction", "]"}], " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Perturbation", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PerturbationLabel", " ", "->", " ", "\"\<\[Delta]\[Phi]\>\""}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
      "PerturbationDependencies", " ", "->", " ", 
       "\[DoubleStruckCapitalX]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScaleFunction", "[", 
    RowBox[{"\[CapitalPhi]var_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalPhi]bg", ",", "\[CapitalPhi]pert", ",", "Xtring", ",", 
       "pLabel", ",", "pDep", ",", "PertQ", ",", 
       "\[CapitalDelta]\[CapitalPhi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PertQ", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Perturbation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pLabel", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "PerturbationLabel", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pDep", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "PerturbationDependencies", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]pert", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PertQ", "===", "False"}], ",", "0", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Xtring", "  ", "=", " ", 
           RowBox[{"\"\<[\>\"", "<>", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"Riffle", "[", 
              RowBox[{
               RowBox[{"ToString", "/@", "pDep"}], ",", "\"\<,\>\""}], "]"}], 
             "]"}], "<>", "\"\<]\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalDelta]\[CapitalPhi]", " ", "=", " ", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"pLabel", "<>", "Xtring"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "DeclareInfinitesimal", "[", "\[CapitalDelta]\[CapitalPhi]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"diff\[CapitalDelta]\[CapitalPhi]1", " ", "=", "  ", 
              RowBox[{"D", "[", 
               RowBox[{"\[CapitalDelta]\[CapitalPhi]", ",", "\[ScriptX]1"}], 
               "]"}]}], " ", ";", "\[IndentingNewLine]", "\t", 
             RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
              "InfinitesimalVariables", ",", 
               "diff\[CapitalDelta]\[CapitalPhi]1"}], "]"}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"InfinitesimalVariables", " ", "=", " ", 
              RowBox[{
              "DeleteDuplicates", "[", "InfinitesimalVariables", "]"}]}], ";",
              "\[IndentingNewLine]", "\t", 
             RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"diff\[CapitalDelta]\[CapitalPhi]2", " ", "=", " ", 
                 RowBox[{"D", "[", 
                  RowBox[{
                  "diff\[CapitalDelta]\[CapitalPhi]1", ",", "\[ScriptX]2"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], 
                ";", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                 "InfinitesimalVariables", ",", 
                  "diff\[CapitalDelta]\[CapitalPhi]2"}], "]"}], ";", 
                "\[IndentingNewLine]", "\t\t", 
                RowBox[{"InfinitesimalVariables", " ", "=", " ", 
                 RowBox[{
                 "DeleteDuplicates", "[", "InfinitesimalVariables", "]"}]}], 
                ";", "\[IndentingNewLine]", "\t\t", 
                RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], 
                ";"}], "\[IndentingNewLine]", "\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"\[ScriptX]2", ",", "\[DoubleStruckCapitalX]"}], 
                "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"\[ScriptX]1", ",", "\[DoubleStruckCapitalX]"}], "}"}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          "\[CapitalDelta]\[CapitalPhi]"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"\[CapitalPhi]", ",", 
        RowBox[{"\[CapitalPhi]var", "+", "\[CapitalPhi]pert"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"Diff\[CapitalPhi]1", " ", ",", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"\[CapitalPhi]", ",", "\[ScriptX]"}], "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptX]", ",", "\[DoubleStruckCapitalX]"}], "}"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"Diff\[CapitalPhi]2", " ", ",", " ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"\[CapitalPhi]", ",", "\[ScriptX]1"}], "]"}], ",", 
            "\[ScriptX]2"}], "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptX]1", ",", "\[DoubleStruckCapitalX]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptX]2", ",", "\[DoubleStruckCapitalX]"}], "}"}]}], 
         "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{RowBox[{
            SubscriptBox["\[PartialD]", "i_"], "\[CapitalPhi]"}]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{"Diff\[CapitalPhi]1", "[", 
            RowBox[{"[", 
              RowBox[{"i_", "+", "1"}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\n", "\t", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{RowBox[{
            SubscriptBox["\[PartialD]", "i_"], 
            RowBox[{
              SubscriptBox["\[PartialD]", "j_"], "\[CapitalPhi]"}]}]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{"Diff\[CapitalPhi]2", "[", 
            RowBox[{"[", 
              RowBox[{
                RowBox[{"i_", "+", "1"}], ",", 
                RowBox[{"j_", "+", "1"}]}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"CheckScale", " ", ",", " ", "True"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UpdateInfinitesimalVariables", "[", "]"}]}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ErrorScaleMessage", " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", "CheckCoordinates"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Error. You must define scale function first.\>\"", 
      "]"}]}], "]"}]}], ";"}]}], "Code",ExpressionUUID->"74b02b72-2e34-44aa-\
8e21-bc7a025af6c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Metric", "Section",ExpressionUUID->"29a3d252-43b8-4692-9f21-d8fa98167d17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ReserveVariable", "[", "PerturbationLabel", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ReserveVariable", "[", "PerturbationDependencies", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ReserveVariable", "[", "PerturbationMatrix", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ReserveVariable", "[", "Approximation", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SetMetric", "]"}], " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Perturbation", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PerturbationLabel", " ", "->", " ", "\"\<h\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "PerturbationDependencies", " ", "->", " ", "\[DoubleStruckCapitalX]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"PerturbationMatrix", " ", "->", " ", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Approximation", " ", "\[Rule]", " ", "None"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetMetric", "[", 
    RowBox[{"metric_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pLabel", ",", "pDep", ",", "TempVar", ",", "h"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "ErrorCoordinatesMessage", ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"BGMetricCov", ",", "metric"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"\[Eta]cov", ",", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i1", ",", "i2"}], "}"}], ",", 
          RowBox[{"BGMetricCov", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "i1"}], ",", 
             RowBox[{"1", "+", "i2"}]}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"BGMetricCon", ",", " ", 
        RowBox[{"Inverse", "[", "BGMetricCov", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"\[Eta]con", ",", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i1", ",", "i2"}], "}"}], ",", 
          RowBox[{"BGMetricCov", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "i1"}], ",", 
             RowBox[{"1", "+", "i2"}]}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FreeVariable", "[", "\[Eta]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{SubscriptBox["\[Eta]", 
           GridBox[{{"i1_", "i2_"}}]]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{
            RowBox[{"BGMetricCov", "[", 
              RowBox[{"[", 
                RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
              RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{SuperscriptBox["\[Eta]", 
           GridBox[{{"i1_", "i2_"}}]]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{
            RowBox[{"BGMetricCon", "[", 
              RowBox[{"[", 
                RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
              RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", "\[Eta]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"PertMetricCov", " ", ",", " ", 
        RowBox[{"OptionValue", "[", "PerturbationMatrix", "]"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PertQ", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Perturbation", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PertQ", ",", 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**"}], "*********)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"PertMetricCov", " ", "===", "False"}], ")"}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
             "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
             "**", "**", "**", "**", "**", "**", "**"}], "*********)"}], 
          "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"pLabel", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "PerturbationLabel", "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"pDep", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "PerturbationDependencies", "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"Xtring", " ", ",", 
             RowBox[{"\"\<[\>\"", "<>", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"Riffle", "[", 
                RowBox[{
                 RowBox[{"ToString", "/@", "pDep"}], ",", "\"\<,\>\""}], 
                "]"}], "]"}], "<>", "\"\<]\>\""}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "       ", 
           RowBox[{"TempVar", " ", "=", " ", 
            RowBox[{"Table", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"h", " ", "=", " ", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<h\>\"", "<>", "\n", "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[GreaterEqual]", "i"}], ",", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"SubscriptNumber", "[", "i", "]"}], "<>", 
                    RowBox[{"SubscriptNumber", "[", "j", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"SubscriptNumber", "[", "j", "]"}], "<>", 
                    RowBox[{"SubscriptNumber", "[", "i", "]"}]}]}], "\n", 
                   "\t\t\t\t\t", "]"}], "<>", "Xtring"}], " ", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"DeclareInfinitesimal", "[", "h", "]"}], ";", 
               "\[IndentingNewLine]", "\t\t", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"diffh1", " ", "=", "  ", 
                   RowBox[{"D", "[", 
                    RowBox[{"h", ",", "\[ScriptX]1"}], "]"}]}], " ", ";", 
                  "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"diffh", "\[NotEqual]", "0"}], ",", 
                    RowBox[{"DeclareInfinitesimal", "[", "diffh", "]"}]}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}], 
                  ";", "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"InfinitesimalVariables", ",", "diffh1"}], "]"}], 
                  ";", "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"InfinitesimalVariables", " ", "=", " ", 
                   RowBox[{
                   "DeleteDuplicates", "[", "InfinitesimalVariables", "]"}]}],
                   ";", "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], 
                  ";", "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"diffh2", " ", "=", " ", 
                    RowBox[{"D", "[", 
                    RowBox[{"diffh1", ",", "\[ScriptX]2"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"Unprotect", "[", "InfinitesimalVariables", "]"}],
                     ";", "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"InfinitesimalVariables", ",", "diffh2"}], "]"}], 
                    ";", "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"InfinitesimalVariables", " ", "=", " ", 
                    RowBox[{
                    "DeleteDuplicates", "[", "InfinitesimalVariables", 
                    "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"Protect", "[", "InfinitesimalVariables", "]"}], 
                    ";"}], "\[IndentingNewLine]", "\t\t\t", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[ScriptX]2", ",", "\[DoubleStruckCapitalX]"}], 
                    "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\t\t", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[ScriptX]1", ",", "\[DoubleStruckCapitalX]"}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\t\t", "h"}], 
              "\[IndentingNewLine]", "\n", "\t\t\t\t", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"PertMetricCov", " ", ",", " ", "TempVar"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"\[Delta]cov", " ", ",", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], ",", 
               RowBox[{"PertMetricCov", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", "+", "i1"}], ",", 
                  RowBox[{"1", "+", "i2"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Notation", "[", 
            RowBox[{
             TemplateBox[{SubscriptBox["h", 
                GridBox[{{"i1_", "i2_"}}]]},
              "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
             TemplateBox[{RowBox[{
                 RowBox[{"PertMetricCov", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                   RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           "\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"TempVar", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[ScriptB]", "=", "0"}], "n"], 
                 RowBox[{
                  RowBox[{"\[Eta]con", "[", 
                   RowBox[{"\[ScriptM]", ",", "\[ScriptA]"}], "]"}], 
                  RowBox[{"\[Eta]con", "[", 
                   RowBox[{"\[ScriptN]", ",", "\[ScriptB]"}], "]"}], 
                  RowBox[{"\[Delta]cov", "[", 
                   RowBox[{"\[ScriptA]", ",", "\[ScriptB]"}], "]"}]}]}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptN]", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"PertMetricCon", " ", ",", " ", "TempVar"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"\[Delta]con", " ", ",", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], ",", 
               RowBox[{"PertMetricCon", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", "+", "i1"}], ",", 
                  RowBox[{"1", "+", "i2"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Notation", "[", 
            RowBox[{
             TemplateBox[{SuperscriptBox["h", 
                GridBox[{{"i1_", "i2_"}}]]},
              "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
             TemplateBox[{RowBox[{
                 RowBox[{"PertMetricCon", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                   RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           "\n", "\t", "\[IndentingNewLine]", "\t", 
           RowBox[{"TempVar", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                RowBox[{
                 RowBox[{"\[Eta]con", "[", 
                  RowBox[{"\[ScriptM]", ",", "\[ScriptA]"}], "]"}], 
                 RowBox[{"\[Delta]cov", "[", 
                  RowBox[{"\[ScriptA]", ",", "\[ScriptN]"}], "]"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptN]", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"PertMetricMix", " ", ",", " ", "TempVar"}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"\[Delta]mix", ",", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], ",", 
               RowBox[{"PertMetricMix", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", "+", "i1"}], ",", 
                  RowBox[{"1", "+", "i2"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Notation", "[", 
            RowBox[{
             TemplateBox[{SuperscriptBox["h", 
                GridBox[{{"i1_", "i2_"}}]]},
              "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
             TemplateBox[{RowBox[{
                 RowBox[{"PertMetricCon", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                   RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
              "NotationTemplateTag"]}], "]"}], ";"}]}], "\[IndentingNewLine]",
          "\t", "\[IndentingNewLine]", "\t", "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**"}], "*********)"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Incase", " ", "of", " ", "PertQ"}], " ", "!=", " ", 
          "False"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TempVar", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetVariable", "[", 
          RowBox[{"PertMetricCov", " ", ",", " ", "TempVar"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetVariable", "[", 
          RowBox[{"PertMetricCon", " ", ",", " ", "TempVar"}], "]"}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
         "**", "**", "**", "**", "**", "**"}], "*********)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"FreeVariable", "[", "g", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"MetricCovM", ",", 
        RowBox[{"BGMetricCov", "+", "PertMetricCov"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AddInputAlias", "[", 
       RowBox[{"\"\<metriccov\>\"", "\[Rule]", 
        TemplateBox[{SubscriptBox["g", 
           GridBox[{{"\[Placeholder]", "\[Placeholder]"}}]]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"MetricConM", ",", 
        RowBox[{"BGMetricCon", "-", "PertMetricCon"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gcov", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{"MetricCovM", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", "a"}], ",", 
          RowBox[{"1", "+", "b"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gcon", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
       RowBox[{"MetricConM", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", "a"}], ",", 
          RowBox[{"1", "+", "b"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{SubscriptBox["g", 
           GridBox[{{"i1_", "i2_"}}]]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{
            RowBox[{"MetricCovM", "[", 
              RowBox[{"[", 
                RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
              RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Notation", "[", 
       RowBox[{
        TemplateBox[{SuperscriptBox["g", 
           GridBox[{{"i1_", "i2_"}}]]},
         "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
        TemplateBox[{RowBox[{
            RowBox[{"MetricConM", "[", 
              RowBox[{"[", 
                RowBox[{"i1_", "+", "1"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
              RowBox[{"i2_", "+", "1"}], "]"}], "]"}]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AddInputAlias", "[", 
       RowBox[{"\"\<metriccon\>\"", "\[Rule]", 
        TemplateBox[{SuperscriptBox["g", 
           GridBox[{{"\[Placeholder]", "\[Placeholder]"}}]]},
         "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"Det", "[", "MetricCovM", "]"}]}], ";", "\[IndentingNewLine]", 
      "   ", 
      RowBox[{"(*", 
       RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
       "*****)"}], "\n", "ErrorCoordinatesMessage", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetVariable", "[", 
       RowBox[{"CheckMetric", ",", "True"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"UpdateInfinitesimalVariables", "[", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ErrorMetricMessage", " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", "CheckMetric"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Error. You must define the metric first.\>\"", 
      "]"}]}], "]"}]}], ";"}]}], "Code",ExpressionUUID->"f7427780-4743-49cd-\
88b7-0b2e535d1e73"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Connection", "Section",ExpressionUUID->"8705fb6e-83b1-4817-9f42-ce46c43deb9c"],

Cell[CellGroupData[{

Cell["Define Christoffel", "Subsection",ExpressionUUID->"3e8d6ede-6c09-4c18-8e9a-e7ed08a413f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetVariable", "[", 
   RowBox[{"CheckChristoffel", " ", ",", " ", "False"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ReserveVariable", "[", "ApplyFunction", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "EvalChristoffel", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"ApplyFunction", " ", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{"#", "&"}], ")"}]}], "}"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EvalChristoffel", "[", 
   RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "TempVar", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "PrintTemporary", "[", "\"\<\\n\\nEvaluating Christoffel...\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Funct", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "ApplyFunction", " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "MetricCovM", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gcov", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"MetricCovM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", "+", "a"}], ",", 
         RowBox[{"1", "+", "b"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gcon", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
      RowBox[{"MetricConM", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", "+", "a"}], ",", 
         RowBox[{"1", "+", "b"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"TempVar", "=", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           UnderoverscriptBox["\[Sum]", 
            RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
           RowBox[{
            FractionBox["1", "2"], 
            SuperscriptBox["g", GridBox[{
               {"\[ScriptB]", "\[ScriptA]"}
              }]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[PartialD]", "\[ScriptM]"], 
               RowBox[{"[", 
                SubscriptBox["g", GridBox[{
                   {"\[ScriptE]", "\[ScriptA]"}
                  }]], "]"}]}], "+", 
              RowBox[{
               SubscriptBox["\[PartialD]", "\[ScriptE]"], 
               RowBox[{"[", 
                SubscriptBox["g", GridBox[{
                   {"\[ScriptM]", "\[ScriptA]"}
                  }]], "]"}]}], "-", 
              RowBox[{
               SubscriptBox["\[PartialD]", "\[ScriptA]"], 
               RowBox[{"[", 
                SubscriptBox["g", GridBox[{
                   {"\[ScriptM]", "\[ScriptE]"}
                  }]], "]"}]}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Funct", " ", "[", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"gcon", "[", 
              RowBox[{"\[ScriptB]", ",", "\[ScriptA]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[PartialD]", "\[ScriptM]"], 
                RowBox[{"[", 
                 RowBox[{"gcov", "[", 
                  RowBox[{"\[ScriptE]", ",", "\[ScriptA]"}], "]"}], "]"}]}], 
               "+", 
               RowBox[{
                SubscriptBox["\[PartialD]", "\[ScriptE]"], 
                RowBox[{"[", 
                 RowBox[{"gcov", "[", 
                  RowBox[{"\[ScriptM]", ",", "\[ScriptA]"}], "]"}], "]"}]}], 
               "-", 
               RowBox[{
                SubscriptBox["\[PartialD]", "\[ScriptA]"], 
                RowBox[{"[", 
                 RowBox[{"gcov", "[", 
                  RowBox[{"\[ScriptM]", ",", "\[ScriptE]"}], "]"}], "]"}]}]}],
               ")"}]}]}], "]"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptB]", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptM]", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptE]", ",", "0", ",", "n"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Epsilon]: \>\"", ",", "\[ScriptE]"}], "}"}]}], 
          "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"ChristoffelM", ",", "TempVar"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Notation", "[", 
      RowBox[{
       TemplateBox[{RowBox[{"{", 
           GridBox[{{"\[Mu]_"}, {
              GridBox[{{"\[Alpha]_", "\[Beta]_"}}]}}], "}"}]},
        "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{RowBox[{"ChristoffelM", "[", 
           RowBox[{"[", 
             RowBox[{
               RowBox[{"1", "+", "\[Mu]_"}], ",", 
               RowBox[{"1", "+", "\[Alpha]_"}], ",", 
               RowBox[{"1", "+", "\[Beta]_"}]}], "]"}], "]"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AddInputAlias", "[", 
      RowBox[{"\"\<chris\>\"", "\[Rule]", 
       TemplateBox[{RowBox[{"{", 
           GridBox[{{"\[Placeholder]"}, {
              GridBox[{{"\[Placeholder]", "\[Placeholder]"}}]}}], "}"}]},
        "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetVariable", "[", 
      RowBox[{"CheckChristoffel", " ", ",", " ", "True"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Code",ExpressionU\
UID->"a69c9014-e9c1-45a4-a736-7d734bb1d09d"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetVariable", "[", 
    RowBox[{"CheckChristoffel", " ", ",", " ", "False"}], "]"}], ";", "\n", 
   RowBox[{"ReserveVariable", "[", "ApplyFunction", "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Options", "[", "EvalChristoffel", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ApplyFunction", " ", "\[Rule]", " ", 
        RowBox[{"(", 
         RowBox[{"#", "&"}], ")"}]}], "}"}], "\n", "\[IndentingNewLine]", 
      RowBox[{"EvalChristoffel", "[", 
       RowBox[{"OptionsPattern", "[", "]"}], "]"}]}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "TempVar", "}"}], ",", "\n", "\t", 
       RowBox[{
       "ErrorCoordinatesMessage", ";", "\n", "\t", "ErrorMetricMessage", ";", 
        "\[IndentingNewLine]", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{"CheckCoordinates", ",", "CheckMetric"}], "]"}], ",", "\n",
           "\t\t", 
          RowBox[{
           RowBox[{
           "PrintTemporary", "[", "\"\<\\n\\nEvaluating Christoffel...\>\"", 
            "]"}], ";", "\n", "\t\t\t", 
           RowBox[{"Funct", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "ApplyFunction", " ", "]"}]}], ";", 
           "\[IndentingNewLine]", "\n", "\t\t\t", 
           RowBox[{"TempVar", "=", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"Monitor", "[", "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
               RowBox[{
                RowBox[{"Funct", " ", "[", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   SuperscriptBox["g", GridBox[{
                    {"\[ScriptB]", "\[ScriptA]"}
                    }]], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptM]"], 
                    RowBox[{"[", 
                    SubscriptBox["g", GridBox[{
                    {"\[ScriptE]", "\[ScriptA]"}
                    }]], "]"}]}], "+", 
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptE]"], 
                    RowBox[{"[", 
                    SubscriptBox["g", GridBox[{
                    {"\[ScriptM]", "\[ScriptA]"}
                    }]], "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptA]"], 
                    RowBox[{"[", 
                    SubscriptBox["g", GridBox[{
                    {"\[ScriptM]", "\[ScriptE]"}
                    }]], "]"}]}]}], ")"}]}]}], "]"}], "\n", "\t\t\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptB]", ",", "0", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptM]", ",", "0", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptE]", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", "\t", ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Epsilon]: \>\"", ",", "\[ScriptE]"}], 
                  "}"}]}], "}"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"ChristoffelM", ",", "TempVar"}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"Christoffel", ",", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "}"}], 
               ",", 
               RowBox[{"ChristoffelM", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"\[Mu]", "+", "1"}], ",", 
                  RowBox[{"\[Alpha]", "+", "1"}], ",", 
                  RowBox[{"\[Beta]", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Notation", "[", 
            RowBox[{
             TemplateBox[{RowBox[{"{", 
                 GridBox[{{"\[Mu]_"}, {
                    GridBox[{{"\[Alpha]_", "\[Beta]_"}}]}}], "}"}]},
              "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
             TemplateBox[{RowBox[{"Christoffel", "[", 
                 RowBox[{"\[Mu]_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"AddInputAlias", "[", 
            RowBox[{"\"\<chris\>\"", "\[Rule]", 
             TemplateBox[{RowBox[{"{", 
                 GridBox[{{"\[Placeholder]"}, {
                    GridBox[{{"\[Placeholder]", "\[Placeholder]"}}]}}], "}"}]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"CheckChristoffel", " ", ",", " ", "True"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "\n", 
      "]"}]}]}], ";", "\n", "\n", 
   RowBox[{"ErrorChristoffelMessage", " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "CheckChristoffel"}], ",", 
      RowBox[{
      "Print", "[", 
       "\"\<Error. You must define Christoffel symbols first.\>\"", "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Code",ExpressionUUID\
->"f6a6eb0b-7fab-4a68-b5bd-207103b71bce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LyST Connection", "Subsection",ExpressionUUID->"6f8fc95e-254d-42dd-945a-6d97daa186d0"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetVariable", "[", 
     RowBox[{"CheckConnection", " ", ",", " ", "False"}], "]"}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"Options", "[", "EvalConnection", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"ApplyFunction", " ", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"#", "&"}], ")"}]}], "}"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EvalConnection", "[", 
      RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "TempVar", "}"}], ",", "\n", "\n", 
       RowBox[{
       "ErrorCoordinatesMessage", ";", "\n", "ErrorMetricMessage", ";", "\n", 
        "ErrorChristoffelMessage", ";", "\[IndentingNewLine]", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
           "CheckCoordinates", ",", "CheckMetric", ",", "CheckChristoffel"}], 
           "]"}], ",", "\n", "\n", "\t   ", 
          RowBox[{
           RowBox[{
           "PrintTemporary", "[", "\"\<\\n\\nEvaluating Connection...\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Funct", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "ApplyFunction", " ", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"TempVar", " ", "=", " ", 
            RowBox[{"Monitor", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Funct", "[", 
                 RowBox[{
                  FractionBox["1", "\[CapitalPhi]"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", GridBox[{
                    {"\[ScriptB]"},
                    {GridBox[{
                    {"\[ScriptM]", "\[ScriptE]"}
                    }]}
                    }], "}"}], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptM]"], 
                    "\[CapitalPhi]"}], "\[CapitalPhi]"], " ", 
                    
                    SubsuperscriptBox["\[Delta]", "\[ScriptE]", 
                    "\[ScriptB]"]}], "-", 
                    RowBox[{
                    SubscriptBox["g", GridBox[{
                    {"\[ScriptM]", "\[ScriptE]"}
                    }]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[ScriptL]", "=", "0"}], "n"], 
                    RowBox[{
                    SuperscriptBox["g", GridBox[{
                    {"\[ScriptB]", "\[ScriptL]"}
                    }]], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptL]"], 
                    "\[CapitalPhi]"}], "\[CapitalPhi]"]}]}]}]}], ")"}]}], 
                 "]"}], "*)"}], "\n", "\t\t\t", 
               RowBox[{
                RowBox[{"Funct", "[", 
                 RowBox[{
                  FractionBox["1", "\[CapitalPhi]"], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", GridBox[{
                    {"\[ScriptB]"},
                    {GridBox[{
                    {"\[ScriptM]", "\[ScriptE]"}
                    }]}
                    }], "}"}], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptM]"], 
                    "\[CapitalPhi]"}], "\[CapitalPhi]"], " ", 
                    
                    SubsuperscriptBox["\[Delta]", "\[ScriptE]", 
                    "\[ScriptB]"]}], "-", 
                    RowBox[{
                    SubscriptBox["g", GridBox[{
                    {"\[ScriptM]", "\[ScriptE]"}
                    }]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[ScriptL]", "=", "0"}], "n"], 
                    RowBox[{
                    SuperscriptBox["g", GridBox[{
                    {"\[ScriptB]", "\[ScriptL]"}
                    }]], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[PartialD]", "\[ScriptL]"], 
                    "\[CapitalPhi]"}], "\[CapitalPhi]"]}]}]}]}], ")"}]}], 
                 "]"}], "\n", "\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptB]", ",", "0", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptM]", ",", "0", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptE]", ",", "0", ",", "n"}], "}"}]}], "]"}], 
              "\n", "\t   ", ",", 
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"\"\<\[Epsilon]: \>\"", ",", "\[ScriptE]"}], 
                  "}"}]}], "}"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"ConnectionM", ",", "TempVar"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Notation", "[", 
            RowBox[{
             TemplateBox[{SubsuperscriptBox["\[CapitalGamma]", 
                GridBox[{{" ", "\[Alpha]_", "\[Beta]_"}}], "\[Mu]_"]},
              "NotationTemplateTag"], " ", "\[DoubleLongLeftRightArrow]", " ", 
             TemplateBox[{RowBox[{"ConnectionM", "[", 
                 RowBox[{"[", 
                   RowBox[{
                    RowBox[{"\[Mu]_", "+", "1"}], ",", 
                    RowBox[{"\[Alpha]_", "+", "1"}], ",", 
                    RowBox[{"\[Beta]_", "+", "1"}]}], "]"}], "]"}]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AddInputAlias", "[", 
            RowBox[{"\"\<conn\>\"", "\[Rule]", 
             TemplateBox[{SubsuperscriptBox["\[CapitalGamma]", 
                GridBox[{{" ", "\[Placeholder]", "\[Placeholder]"}}], 
                "\[Placeholder]"]},
              "NotationTemplateTag"]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"SetVariable", "[", 
            RowBox[{"CheckConnection", " ", ",", " ", "True"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ErrorConnectionMessage", " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "CheckChristoffel"}], ",", 
       RowBox[{
       "Print", "[", "\"\<Error. You must define Connection first.\>\"", 
        "]"}]}], "]"}]}], ";"}]}]}]], "Code",ExpressionUUID->"be6e36a1-6494-\
4796-af77-b0db4e24cd46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Curvature", "Subsection",ExpressionUUID->"7d379093-40d2-4257-a12c-5fa5fccecf27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"CurvatureM", ",", "Curvature", ",", "CheckCurvature"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"CurvatureM", ",", "Curvature", ",", "CheckCurvature"}], "]"}], 
   ";"}], "\n", "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CheckConnection", " ", "=", " ", "False"}], ";"}], "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DefineCurvature", "[", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", "\n", 
     RowBox[{
     "ErrorScaleMessage", ";", "\n", "ErrorCoordinatesMessage", ";", "\n", 
      "ErrorMetricMessage", ";", "\n", "ErrorChristoffelMessage", ";", "\n", 
      "ErrorConnectionMessage", ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "***********************************************)"}], 
      "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Christoffel", " ", "Curvature", " ", "Tensor"}], " ", "*)"}], 
      "\n", "\t", 
      RowBox[{
      "PrintTemporary", "[", 
       "\"\<\\n\\nEvaluating Christoffel Curvature...\>\"", "]"}], ";", "\n", 
      "\t", 
      RowBox[{"ChristoffelCurvatureTensorM", "=", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\n", "\t", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Christoffel", "[", 
                RowBox[{"\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                "]"}], ",", 
               RowBox[{"\[DoubleStruckX]", "[", "\[ScriptA]", "]"}]}], "]"}], 
             "-", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Christoffel", "[", 
                RowBox[{"\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                "]"}], ",", 
               RowBox[{"\[DoubleStruckX]", "[", "\[ScriptB]", "]"}]}], "]"}], 
             "+", "\n", "\t\t", 
             RowBox[{"+", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptA]"}], 
                   "]"}], 
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                   "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptB]"}], 
                   "]"}], 
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                   "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[ScriptR]", ",", "0", ",", "n"}], "}"}]}], 
               "]"}]}]}], "]"}], "\n", "\t\t", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[ScriptL]", ",", "0", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[ScriptB]", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "{", "\"\< Christoffel Curvature Tensor - \
\\!\\(\\*SubscriptBox[SuperscriptBox[\\(R\\), \\(\[Mu]\\)], \\(\[Lambda]\
\[Alpha]\[Beta]\\)]\\) \>\"", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Lambda]: \>\"", ",", "\[ScriptL]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}]}], "}"}],
           "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"ChristoffelCurvatureTensor", "[", 
        RowBox[{
        "\[ScriptS]_", ",", "\[ScriptN]_", ",", "\[ScriptM]_", ",", 
         "\[ScriptA]_"}], "]"}], ":=", 
       RowBox[{"ChristoffelCurvatureTensorM", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", "\[ScriptS]"}], ",", 
          RowBox[{"1", "+", "\[ScriptN]"}], ",", 
          RowBox[{"1", "+", "\[ScriptM]"}], ",", 
          RowBox[{"1", "+", "\[ScriptA]"}]}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"Notation", "[", 
       RowBox[{
        RowBox[{"ParsedBoxWrapper", "[", 
         RowBox[{"SubsuperscriptBox", "[", 
          RowBox[{"\"\<\[ScriptCapitalR]\>\"", ",", " ", 
           RowBox[{"GridBox", "[", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
              "\"\< \>\"", ",", " ", "\"\<\[ScriptN]_\>\"", ",", " ", 
               "\"\<\[ScriptM]_\>\"", ",", " ", "\"\<\[ScriptA]_\>\""}], 
              "}"}], "}"}], "]"}], ",", " ", "\"\<\[ScriptS]_\>\""}], "]"}], 
         "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
        RowBox[{"ParsedBoxWrapper", "[", 
         RowBox[{"RowBox", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ChristoffelCurvatureTensorM\>\"", ",", " ", "\"\<[\>\"", ",", 
            " ", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptS]_\>\""}], "}"}], "]"}], ",", " ", 
                  "\"\<,\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptN]_\>\""}], "}"}], "]"}], ",", " ", 
                  "\"\<,\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptM]_\>\""}], "}"}], "]"}], ",", " ", 
                  "\"\<,\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptA]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], 
               ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}],
            "}"}], "]"}], "]"}]}], "]"}], ";"}]}], "\n", "\n", 
    RowBox[{"(*", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
         "CheckScale", ",", "CheckCoordinates", ",", "CheckMetric", ",", 
          "CheckChristoffel", ",", "CheckConnection"}], "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"Unprotect", "[", 
          RowBox[{"CurvatureM", ",", "Curvature", ",", "CheckCurvature"}], 
          "]"}], ";", "\n", 
         RowBox[{"ClearAll", "[", 
          RowBox[{"CurvatureM", ",", "Curvature", ",", "CheckCurvature"}], 
          "]"}], ";", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", " ", 
          RowBox[{"Christoffel", " ", "Curvature", " ", "Tensor"}], " ", 
          "*)"}], "\n", 
         RowBox[{
         "PrintTemporary", "[", 
          "\"\<\\n\\nEvaluating Christoffel Curvature...\>\"", "]"}], ";", 
         "\n", 
         RowBox[{"ChristoffelCurvatureTensorM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\n", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                   "]"}], ",", 
                  RowBox[{"\[DoubleStruckX]", "[", "\[ScriptA]", "]"}]}], 
                 "]"}], "-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"Christoffel", "[", 
                   RowBox[{
                   "\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                   "]"}], ",", 
                  RowBox[{"\[DoubleStruckX]", "[", "\[ScriptB]", "]"}]}], 
                 "]"}], "+", "\n", 
                RowBox[{"+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptA]"}], 
                    "]"}], 
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                    "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptB]"}], 
                    "]"}], 
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                    "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[ScriptR]", ",", "0", ",", "n"}], "}"}]}], 
                  "]"}]}]}], "]"}], "\n", ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptL]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptB]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Christoffel Curvature Tensor - \
\\!\\(\\*SubscriptBox[SuperscriptBox[\\(R\\), \\(\[Mu]\\)], \\(\[Lambda]\
\[Alpha]\[Beta]\\)]\\) \>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Lambda]: \>\"", ",", "\[ScriptL]"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"ChristoffelCurvatureTensor", "[", 
           RowBox[{
           "\[ScriptS]_", ",", "\[ScriptN]_", ",", "\[ScriptM]_", ",", 
            "\[ScriptA]_"}], "]"}], ":=", 
          RowBox[{"ChristoffelCurvatureTensorM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptS]"}], ",", 
             RowBox[{"1", "+", "\[ScriptN]"}], ",", 
             RowBox[{"1", "+", "\[ScriptM]"}], ",", 
             RowBox[{"1", "+", "\[ScriptA]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubsuperscriptBox", "[", 
             RowBox[{"\"\<\[ScriptCapitalR]\>\"", ",", " ", 
              RowBox[{"GridBox", "[", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\< \>\"", ",", " ", "\"\<\[ScriptN]_\>\"", ",", " ", 
                  "\"\<\[ScriptM]_\>\"", ",", " ", "\"\<\[ScriptA]_\>\""}], 
                 "}"}], "}"}], "]"}], ",", " ", "\"\<\[ScriptS]_\>\""}], 
             "]"}], "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<ChristoffelCurvatureTensorM\>\"", ",", " ", "\"\<[\>\"", 
               ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptS]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptN]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptM]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptA]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], 
                  ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
               "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", " ", 
          RowBox[{"Curvature", " ", "Tensor"}], " ", "*)"}], "\n", 
         RowBox[{
         "PrintTemporary", "[", 
          "\"\<\\n\\nEvaluating Curvature Tensor...\>\"", "]"}], ";", "\n", 
         RowBox[{"CurvatureTensorM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\n", 
             RowBox[{
              RowBox[{"Expand", "[", "\n", 
               RowBox[{
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"\[CapitalPhi]", "^", "2"}]}], " ", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[CapitalPhi]", " ", 
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                    "]"}]}], ",", 
                   RowBox[{"\[DoubleStruckX]", "[", "\[ScriptA]", "]"}]}], 
                  "]"}]}], "-", 
                RowBox[{
                 RowBox[{"1", "/", 
                  RowBox[{"\[CapitalPhi]", "^", "2"}]}], " ", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[CapitalPhi]", " ", 
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                    "]"}]}], ",", 
                   RowBox[{"\[DoubleStruckX]", "[", "\[ScriptB]", "]"}]}], 
                  "]"}]}], "+", "\n", 
                RowBox[{"+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptA]"}], 
                    "]"}], 
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptB]"}], 
                    "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptR]", ",", "\[ScriptB]"}], 
                    "]"}], 
                    RowBox[{"Connection", "[", 
                    RowBox[{
                    "\[ScriptR]", ",", "\[ScriptL]", ",", "\[ScriptA]"}], 
                    "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\[ScriptR]", ",", "0", ",", "n"}], "}"}]}], 
                  "]"}]}]}], "]"}], "\n", ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptL]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptB]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Curvature Tensor - \
\\!\\(\\*SubscriptBox[SuperscriptBox[\\(R\\), \\(\[Mu]\\)], \\(\[Lambda]\
\[Alpha]\[Beta]\\)]\\) \>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Lambda]: \>\"", ",", "\[ScriptL]"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"CurvatureTensor", "[", 
           RowBox[{
           "\[ScriptS]_", ",", "\[ScriptN]_", ",", "\[ScriptM]_", ",", 
            "\[ScriptA]_"}], "]"}], ":=", 
          RowBox[{"CurvatureTensorM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptS]"}], ",", 
             RowBox[{"1", "+", "\[ScriptN]"}], ",", 
             RowBox[{"1", "+", "\[ScriptM]"}], ",", 
             RowBox[{"1", "+", "\[ScriptA]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubsuperscriptBox", "[", 
             RowBox[{"\"\<R\>\"", ",", " ", 
              RowBox[{"GridBox", "[", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\< \>\"", ",", " ", "\"\<\[ScriptN]_\>\"", ",", " ", 
                  "\"\<\[ScriptM]_\>\"", ",", " ", "\"\<\[ScriptA]_\>\""}], 
                 "}"}], "}"}], "]"}], ",", " ", "\"\<\[ScriptS]_\>\""}], 
             "]"}], "]"}], " ", "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<CurvatureTensorM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptS]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptN]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptM]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptA]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], 
                  ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
               "\"\<]\>\""}], "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Contracting", " ", "curvature", " ", "with", " ", "Metric"}], " ", 
          "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{"True", ",", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Covariant", " ", "components", " ", "of", " ", "curvature", " ", 
             "tensor"}], " ", "*)"}], "\n", 
           RowBox[{
            RowBox[{"CurvatureTensorCovM", " ", "=", " ", 
             RowBox[{"Monitor", "[", 
              RowBox[{
               RowBox[{"Table", "[", "\n", 
                RowBox[{
                 RowBox[{"Expand", "[", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MetricCov", "[", 
                    RowBox[{"\[ScriptR]", ",", "\[ScriptM]"}], "]"}], 
                    RowBox[{"CurvatureTensor", "[", 
                    RowBox[{
                    "\[ScriptR]", ",", "\[ScriptN]", ",", "\[ScriptA]", ",", 
                    "\[ScriptB]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[ScriptR]", ",", "0", ",", "n"}], "}"}]}], 
                   "]"}], "]"}], "\n", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[ScriptN]", ",", "0", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[ScriptB]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"Grid", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "{", "\"\< Curvature Subscript[K, \
\[Mu]\[Nu]\[Alpha]\[Beta]] \>\"", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Nu]: \>\"", ",", "\[ScriptN]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Beta]: \>\"", ",", "\[ScriptB]"}], "}"}]}], 
                 "}"}], "]"}]}], "]"}]}], ";", "\n", 
            RowBox[{
             RowBox[{"CurvatureTensorCov", "[", 
              RowBox[{
              "\[ScriptA]_", ",", "\[ScriptB]_", ",", "\[ScriptC]_", ",", 
               "\[ScriptD]_"}], "]"}], " ", ":=", " ", 
             RowBox[{"CurvatureTensorConM", " ", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", "+", "\[ScriptA]"}], ",", 
                RowBox[{"1", "+", "\[ScriptB]"}], ",", 
                RowBox[{"1", "+", "\[ScriptC]"}], ",", 
                RowBox[{"1", "+", "\[ScriptD]"}]}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"Notation", "[", 
             RowBox[{
              RowBox[{"ParsedBoxWrapper", "[", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"SubscriptBox", "[", 
                   RowBox[{"\"\<R\>\"", ",", " ", 
                    RowBox[{"GridBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\[ScriptM]_\>\"", ",", " ", "\"\<\[ScriptN]_\>\"", 
                    ",", " ", "\"\<\[ScriptA]_\>\"", ",", " ", 
                    "\"\<\[ScriptB]_\>\""}], "}"}], "}"}], "]"}]}], "]"}], 
                  ",", " ", "\"\< \>\""}], "}"}], "]"}], "]"}], " ", 
              "\[DoubleLongLeftRightArrow]", " ", 
              RowBox[{"ParsedBoxWrapper", "[", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\< \>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<CurvatureTensorCovM\>\"", ",", " ", "\"\<[\>\"", ",",
                     " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<[\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptM]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptN]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptA]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[ScriptB]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], 
                    ",", " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<]\>\""}], "}"}], "]"}]}], "}"}], "]"}], "]"}]}], 
             "]"}], ";"}]}], "\n", 
          RowBox[{"(*", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Contravariant", " ", "components", " ", "of", " ", "curvature", 
             " ", "tensor"}], " ", "*)"}], "\n", 
           RowBox[{
            RowBox[{"CurvatureTensorConM", " ", "=", " ", 
             RowBox[{"Table", "[", "\n", 
              RowBox[{
               RowBox[{"Expand", "[", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"\[ScriptB]", "=", "0"}], "n"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"\[ScriptC]", "=", "0"}], "n"], 
                   RowBox[{
                    RowBox[{"CurvatureTensor", "[", 
                    RowBox[{
                    "\[ScriptM]", ",", "\[ScriptA]", ",", "\[ScriptB]", ",", 
                    "\[ScriptC]"}], "]"}], 
                    RowBox[{"MetricCon", "[", 
                    RowBox[{"\[ScriptA]", ",", "\[ScriptN]"}], "]"}], 
                    RowBox[{"MetricCon", "[", 
                    RowBox[{"\[ScriptB]", ",", "\[ScriptP]"}], "]"}], 
                    RowBox[{"MetricCon", "[", 
                    RowBox[{"\[ScriptC]", ",", "\[ScriptQ]"}], "]"}]}]}]}]}], 
                "]"}], "\n", ",", 
               RowBox[{"{", 
                RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[ScriptN]", ",", "0", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[ScriptP]", ",", "0", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[ScriptQ]", ",", "0", ",", "3"}], "}"}]}], "]"}]}], 
            ";", "\n", "\n", 
            RowBox[{
             RowBox[{"CurvatureTensorCon", "[", 
              RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], " ", ":=",
              " ", 
             RowBox[{"CurvatureTensorConM", " ", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", "+", "a"}], ",", 
                RowBox[{"1", "+", "b"}], ",", 
                RowBox[{"1", "+", "c"}], ",", 
                RowBox[{"1", "+", "d"}]}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"Notation", "[", 
             RowBox[{
              RowBox[{"R", "^", "\[ScriptM]_"}], "\t", "\[ScriptN]_", "\t", 
              "\[ScriptP]_", "\t", 
              RowBox[{
              "\[ScriptQ]_", " ", "\[DoubleLongLeftRightArrow]", " ", 
               RowBox[{"CurvatureTensorConM", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"1", "+", "\[ScriptM]_"}], ",", 
                  RowBox[{"1", "+", "\[ScriptN]_"}], ",", 
                  RowBox[{"1", "+", "\[ScriptP]_"}], ",", 
                  RowBox[{"1", "+", "\[ScriptQ]_"}]}], "]"}], "]"}]}]}], 
             "]"}], ";"}], "*)"}], "\n", "\n", "]"}], ";", "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"Ricci", "-", 
           RowBox[{"Christoffel", " ", "tensor", " ", 
            RowBox[{"Subscript", "[", 
             RowBox[{"R", ",", " ", "\[Mu]\[Sigma]"}], "]"}]}]}], " ", "*)"}],
          "\n", 
         RowBox[{
         "PrintTemporary", "[", 
          "\"\<\\n\\nEvaluating Ricci-Christoffel Tensor...\>\"", "]"}], ";", 
         "\n", 
         RowBox[{"ChristoffelRicciCovM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptT]", "=", "0"}], "n"], 
                RowBox[{"ChristoffelCurvatureTensor", "[", 
                 RowBox[{
                 "\[ScriptT]", ",", "\[ScriptN]", ",", "\[ScriptA]", ",", 
                  "\[ScriptT]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptN]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Ricci \\!\\(\\*SubscriptBox[\\(R\\), \\(\[Nu]\
\[Alpha]\\)]\\) \>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Nu]: \>\"", ",", "\[ScriptN]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"ChristoffelRicciCov", "[", 
           RowBox[{"\[ScriptA]_", ",", "\[ScriptB]_"}], "]"}], ":=", 
          RowBox[{"ChristoffelRicciCovM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptA]"}], ",", 
             RowBox[{"1", "+", "\[ScriptB]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubscriptBox", "[", 
             RowBox[{"\"\<\[ScriptCapitalR]\>\"", ",", " ", 
              RowBox[{"GridBox", "[", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<\[Alpha]_\>\"", ",", " ", "\"\<\[Beta]_\>\""}], 
                 "}"}], "}"}], "]"}]}], "]"}], "]"}], " ", 
           "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<ChristoffelRicciCovM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Alpha]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Beta]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], 
              "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"Ricci", " ", "tensor", " ", 
           RowBox[{"Subscript", "[", 
            RowBox[{"R", ",", " ", "\[Mu]\[Sigma]"}], "]"}]}], " ", "*)"}], 
         "\n", 
         RowBox[{
         "PrintTemporary", "[", "\"\<\\n\\nEvaluating Ricci Tensor...\>\"", 
          "]"}], ";", "\n", 
         RowBox[{"RicciCovM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptT]", "=", "0"}], "n"], 
                RowBox[{"CurvatureTensor", "[", 
                 RowBox[{
                 "\[ScriptT]", ",", "\[ScriptN]", ",", "\[ScriptA]", ",", 
                  "\[ScriptT]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptN]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptA]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Ricci \\!\\(\\*SubscriptBox[\\(R\\), \\(\[Nu]\
\[Alpha]\\)]\\) \>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Nu]: \>\"", ",", "\[ScriptN]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Alpha]: \>\"", ",", "\[ScriptA]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"RicciCov", "[", 
           RowBox[{"\[ScriptA]_", ",", "\[ScriptB]_"}], "]"}], ":=", 
          RowBox[{"RicciCovM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptA]"}], ",", 
             RowBox[{"1", "+", "\[ScriptB]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubscriptBox", "[", 
             RowBox[{"\"\<R\>\"", ",", " ", 
              RowBox[{"GridBox", "[", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<\[Alpha]_\>\"", ",", " ", "\"\<\[Beta]_\>\""}], 
                 "}"}], "}"}], "]"}]}], "]"}], "]"}], " ", 
           "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<RicciCovM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Alpha]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Beta]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], 
              "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{
           RowBox[{"Mixed", " ", "Ricci"}], "-", 
           RowBox[{"Christoffel", " ", "tensor", " ", 
            RowBox[{"Subscript", "[", 
             RowBox[{"R", ",", " ", "\[Mu]\[Sigma]"}], "]"}]}]}], " ", "*)"}],
          "\n", 
         RowBox[{"ChristoffelRicciMixM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                RowBox[{
                 RowBox[{"MetricCon", "[", 
                  RowBox[{"\[ScriptS]", ",", "\[ScriptA]"}], "]"}], 
                 RowBox[{"ChristoffelRicciCov", "[", 
                  RowBox[{"\[ScriptA]", ",", "\[ScriptM]"}], "]"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptS]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Ricci \\!\\(\\*SubsuperscriptBox[\\(R\\), GridBox[{\
\n{\\(\\\\\\ \\), \\(\[Mu]\\)}\n}], GridBox[{\n{\\(\[Sigma]\\), \\(\\\\\\ \
\\)}\n}]]\\)\>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sigma]: \>\"", ",", "\[ScriptS]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"ChristoffelRicciMix", "[", 
           RowBox[{"\[ScriptA]_", ",", "\[ScriptB]_"}], "]"}], ":=", 
          RowBox[{"ChristoffelRicciMixM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptA]"}], ",", 
             RowBox[{"1", "+", "\[ScriptB]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubsuperscriptBox", "[", 
             RowBox[{
             "\"\<\[ScriptCapitalR]\>\"", ",", " ", "\"\<\[Mu]_\>\"", ",", 
              " ", "\"\<\[Sigma]_\>\""}], "]"}], "]"}], " ", 
           "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<ChristoffelRicciMixM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Sigma]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Mu]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], 
              "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"MixedRicci", " ", "tensor", " ", 
           RowBox[{"Subscript", "[", 
            RowBox[{"R", ",", " ", "\[Mu]\[Sigma]"}], "]"}]}], " ", "*)"}], 
         "\n", 
         RowBox[{"RicciMixM", "=", 
          RowBox[{"Monitor", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Expand", "[", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
                RowBox[{
                 RowBox[{"MetricCon", "[", 
                  RowBox[{"\[ScriptS]", ",", "\[ScriptA]"}], "]"}], 
                 RowBox[{"RicciCov", "[", 
                  RowBox[{"\[ScriptA]", ",", "\[ScriptM]"}], "]"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptS]", ",", "0", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptM]", ",", "0", ",", "3"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Grid", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "{", "\"\< Ricci \\!\\(\\*SubsuperscriptBox[\\(R\\), GridBox[{\
\n{\\(\\\\\\ \\), \\(\[Mu]\\)}\n}], GridBox[{\n{\\(\[Sigma]\\), \\(\\\\\\ \
\\)}\n}]]\\)\>\"", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sigma]: \>\"", ",", "\[ScriptS]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Mu]: \>\"", ",", "\[ScriptM]"}], "}"}]}], 
              "}"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"RicciMix", "[", 
           RowBox[{"\[ScriptA]_", ",", "\[ScriptB]_"}], "]"}], ":=", 
          RowBox[{"RicciMixM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptA]"}], ",", 
             RowBox[{"1", "+", "\[ScriptB]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubsuperscriptBox", "[", 
             RowBox[{
             "\"\<R\>\"", ",", " ", "\"\<\[Mu]_\>\"", ",", " ", 
              "\"\<\[Sigma]_\>\""}], "]"}], "]"}], " ", 
           "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<RicciMixM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Sigma]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Mu]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], 
              "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"Christoffel", " ", "Curvature", " ", "Scalar", " ", "R"}], 
          " ", "*)"}], "\n", 
         RowBox[{
         "PrintTemporary", "[", 
          "\"\<\\n\\nEvaluating Christoffel Curvature Scalar...\>\"", "]"}], 
         ";", "\n", 
         RowBox[{"\[ScriptCapitalR]", " ", "=", 
          RowBox[{"Expand", "[", " ", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
            RowBox[{"ChristoffelRicciMix", "[", 
             RowBox[{"\[ScriptA]", ",", "\[ScriptA]"}], "]"}]}], "]"}]}], ";",
          "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"Curvature", " ", "Scalar", " ", "R"}], " ", "*)"}], "\n", 
         RowBox[{
         "PrintTemporary", "[", 
          "\"\<\\n\\nEvaluating Curvature Scalar...\>\"", "]"}], ";", "\n", 
         RowBox[{"R", " ", "=", 
          RowBox[{"Expand", "[", " ", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"\[ScriptA]", "=", "0"}], "n"], 
            RowBox[{"RicciMix", "[", 
             RowBox[{"\[ScriptA]", ",", "\[ScriptA]"}], "]"}]}], "]"}]}], ";",
          "\n", "\n", "\n", 
         RowBox[{"(*", "***********************************************)"}], 
         "\n", 
         RowBox[{"(*", "  ", 
          RowBox[{"Einstein", " ", "tensor", " ", 
           RowBox[{"Subscript", "[", 
            RowBox[{"G", ",", " ", "\[Mu]\[Sigma]"}], "]"}]}], " ", "*)"}], 
         "\n", 
         RowBox[{
         "PrintTemporary", "[", "\"\<\\n\\nEvaluating Einstein Tensor...\>\"",
           "]"}], ";", "\n", 
         RowBox[{"EinsteinCovM", " ", "=", " ", 
          RowBox[{"Expand", "[", 
           RowBox[{"RicciCovM", " ", "-", " ", 
            RowBox[{
             RowBox[{"1", "/", "2"}], " ", "MetricCovM", " ", "R"}]}], " ", 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"EinsteinCov", "[", 
           RowBox[{"\[ScriptA]_", ",", "\[ScriptB]_"}], "]"}], ":=", 
          RowBox[{"EinsteinCovM", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", "+", "\[ScriptA]"}], ",", 
             RowBox[{"1", "+", "\[ScriptB]"}]}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"Notation", "[", 
          RowBox[{
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"SubscriptBox", "[", 
             RowBox[{"\"\<G\>\"", ",", " ", 
              RowBox[{"GridBox", "[", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"\"\<\[Alpha]_\>\"", ",", " ", "\"\<\[Beta]_\>\""}], 
                 "}"}], "}"}], "]"}]}], "]"}], "]"}], " ", 
           "\[DoubleLongLeftRightArrow]", " ", 
           RowBox[{"ParsedBoxWrapper", "[", 
            RowBox[{"RowBox", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<EinsteinCovM\>\"", ",", " ", "\"\<[\>\"", ",", " ", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<[\>\"", ",", " ", 
                  RowBox[{"RowBox", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Alpha]_\>\""}], "}"}], "]"}], ",", " ", 
                    "\"\<,\>\"", ",", " ", 
                    RowBox[{"RowBox", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1\>\"", ",", " ", "\"\<+\>\"", ",", " ", 
                    "\"\<\[Beta]_\>\""}], "}"}], "]"}]}], "}"}], "]"}], ",", 
                  " ", "\"\<]\>\""}], "}"}], "]"}], ",", " ", "\"\<]\>\""}], 
              "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", 
         RowBox[{"CheckCurvature", " ", "=", " ", "True"}], ";", "\n", 
         RowBox[{"Protect", "[", 
          RowBox[{"CurvatureM", ",", "Curvature", ",", "CheckCurvature"}], 
          "]"}], ";"}]}], "\n", "\n", "]"}], ";"}], "*)"}], "\n", "\n", 
    "]"}]}], ";"}]}], "Code",ExpressionUUID->"2a0de6e2-afca-4c84-b7bf-\
130144bf1083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ErrorChristoffelMessage", " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", "CheckChristoffel"}], ",", 
     RowBox[{
     "Print", "[", 
      "\"\<Error. You must define Christoffel symbols first.\>\"", "]"}]}], 
    "]"}]}], ";"}]], "Code",ExpressionUUID->"ae3ed9d5-40d3-428e-a1b1-\
d3a83b6f8e6e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 706},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"CMU Article.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 100, 0, 63, "Title",ExpressionUUID->"117238c6-4506-4b0f-b7d7-a743167ebbfc"],
Cell[683, 24, 1263, 36, 296, "Code",ExpressionUUID->"54a1dfe7-3b5d-43d4-b5ce-74f2c5cc3c3c"],
Cell[1949, 62, 172, 3, 53, "Code",ExpressionUUID->"e8d87e34-e868-49a2-b103-3c6aea785bbd"],
Cell[CellGroupData[{
Cell[2146, 69, 83, 0, 65, "Section",ExpressionUUID->"bef6e7d3-2855-4e16-b213-502980ed799f"],
Cell[2232, 71, 93, 0, 25, "TextIndent",ExpressionUUID->"d27fdd2e-5569-46e3-bd26-6b6af0518953"],
Cell[2328, 73, 2260, 56, 98, "Code",ExpressionUUID->"57300198-a71e-4459-aab1-d94c1243b856"],
Cell[4591, 131, 95, 0, 25, "TextIndent",ExpressionUUID->"71c64f7c-ae1b-4592-ac0e-0a2dcd6362be"],
Cell[4689, 133, 6582, 162, 120, "Code",ExpressionUUID->"0bb69e37-aa99-4e96-bd4f-08efa53301b1"],
Cell[11274, 297, 92, 0, 25, "TextIndent",ExpressionUUID->"38b5b725-cd4e-423c-be2e-87acad8783e1"],
Cell[11369, 299, 1265, 36, 238, "Code",ExpressionUUID->"140996a3-a03b-424a-922e-4bacaf5a002d"],
Cell[12637, 337, 88, 0, 25, "TextIndent",ExpressionUUID->"9ef7381e-6eba-46c9-80c6-6f3f803182fe"],
Cell[12728, 339, 414, 12, 76, "Code",ExpressionUUID->"071970c7-f3ea-4260-9a38-72ee982cf2c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13179, 356, 83, 0, 65, "Section",ExpressionUUID->"c949827c-b67c-4457-84a3-784f7f6bb683"],
Cell[13265, 358, 106, 0, 25, "TextIndent",ExpressionUUID->"588eadd5-e3e4-4d90-9106-34a8939d7737"],
Cell[13374, 360, 3607, 89, 692, "Code",ExpressionUUID->"3ec4399e-3bc6-445d-9b5a-cf677b0add8f"],
Cell[16984, 451, 110, 0, 25, "TextIndent",ExpressionUUID->"51e1557d-f923-41a3-83eb-4697de2d3ff9"],
Cell[17097, 453, 1052, 26, 76, "Code",ExpressionUUID->"01c358b0-1fbc-4f6e-b0c4-adf83cbf7350"],
Cell[18152, 481, 110, 0, 25, "TextIndent",ExpressionUUID->"bab1d243-63d0-4544-a66c-ee8d8b15ea04"],
Cell[CellGroupData[{
Cell[18287, 485, 156, 2, 53, "Code",ExpressionUUID->"8a93146a-104e-4b21-a1ab-e9285ddc69d2"],
Cell[18446, 489, 117, 1, 32, "Output",ExpressionUUID->"1e370418-7caf-4af4-9d0d-8ca618d7a4b5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18612, 496, 89, 0, 65, "Section",ExpressionUUID->"3a77df19-f3c2-408a-a93e-0aaf75c43092"],
Cell[CellGroupData[{
Cell[18726, 500, 2093, 51, 406, "Code",ExpressionUUID->"a86929e7-4172-4f88-b1de-30656716a53f"],
Cell[20822, 553, 184, 4, 32, "Output",ExpressionUUID->"a7cbcc99-e616-4a3c-915d-f386c7ed017f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21055, 563, 97, 0, 65, "Section",ExpressionUUID->"dba31cef-fb8b-4d2a-be39-f909bb49dc6d"],
Cell[21155, 565, 2876, 76, 494, "Code",ExpressionUUID->"b31d658d-b908-4e64-acb3-ff989cd9aa12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24068, 646, 83, 0, 65, "Section",ExpressionUUID->"f9efed55-f219-4e9f-880d-2405559b2651"],
Cell[CellGroupData[{
Cell[24176, 650, 169, 3, 32, "Input",ExpressionUUID->"efebd265-3695-445d-bc35-a9eba5b46fea"],
Cell[24348, 655, 111, 1, 32, "Output",ExpressionUUID->"b8be12d7-1e79-4497-aff5-17e5a7054ec2"]
}, Open  ]],
Cell[24474, 659, 11815, 256, 1627, "Code",ExpressionUUID->"23322569-a03b-41a5-a115-0313470b4cc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36326, 920, 92, 0, 65, "Section",ExpressionUUID->"2b3c5ccf-c52e-41f9-9b47-8dc9d657a024"],
Cell[36421, 922, 3262, 75, 523, "Code",ExpressionUUID->"598caa73-de07-4b88-8bec-c51385d135f3"]
}, Closed]],
Cell[CellGroupData[{
Cell[39720, 1002, 102, 0, 39, "Section",ExpressionUUID->"55a0b5c5-2c21-4a16-97e6-5ec3b238814a"],
Cell[39825, 1004, 8253, 187, 1126, "Code",ExpressionUUID->"74b02b72-2e34-44aa-8e21-bc7a025af6c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48115, 1196, 87, 0, 65, "Section",ExpressionUUID->"29a3d252-43b8-4692-9f21-d8fa98167d17"],
Cell[48205, 1198, 20940, 457, 2531, "Code",ExpressionUUID->"f7427780-4743-49cd-88b7-0b2e535d1e73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69182, 1660, 91, 0, 65, "Section",ExpressionUUID->"8705fb6e-83b1-4817-9f42-ce46c43deb9c"],
Cell[CellGroupData[{
Cell[69298, 1664, 95, 0, 47, "Subsection",ExpressionUUID->"3e8d6ede-6c09-4c18-8e9a-e7ed08a413f2"],
Cell[69396, 1666, 6165, 150, 770, "Code",ExpressionUUID->"a69c9014-e9c1-45a4-a736-7d734bb1d09d"],
Cell[75564, 1818, 6297, 138, 1059, "Code",ExpressionUUID->"f6a6eb0b-7fab-4a68-b5bd-207103b71bce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81898, 1961, 92, 0, 47, "Subsection",ExpressionUUID->"6f8fc95e-254d-42dd-945a-6d97daa186d0"],
Cell[81993, 1963, 7055, 165, 803, "Code",ExpressionUUID->"be6e36a1-6494-4796-af77-b0db4e24cd46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89085, 2133, 93, 0, 47, "Subsection",ExpressionUUID->"7d379093-40d2-4257-a12c-5fa5fccecf27"],
Cell[89181, 2135, 48230, 1086, 3090, "Code",ExpressionUUID->"2a0de6e2-afca-4c84-b7bf-130144bf1083"],
Cell[137414, 3223, 356, 10, 53, "Code",ExpressionUUID->"ae3ed9d5-40d3-428e-a1b1-d3a83b6f8e6e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

